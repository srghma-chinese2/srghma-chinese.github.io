<!DOCTYPE HTML>
    <html>
      <head>
        <meta charset="utf-8">
        <title>Index</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9842250826106845" crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F6PE0WTMBJ"></script>
<link rel="stylesheet" href="main.css">
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F6PE0WTMBJ');
</script>
<script src="myscript-common.js"></script>
  </head>
  <body class="nightMode" style="text-align: initial;">

  <p>About the project</p>

  <ol>
    <li><a href="https://github.com/srghma-chinese2/srghma-chinese2.github.io#readme">README</a></li>
    <li><a href="https://github.com/srghma-chinese2/srghma-chinese2.github.io">https://github.com/srghma-chinese2/srghma-chinese2.github.io</a></li>
    <li><a href="https://t.me/srghmachinese">https://t.me/srghmachinese</a> (announce on <a href="https://bkrs.info/taolun/thread-332123-post-794062.html#pid794062">bkrs</a>)</li>
  </ol>

  <p>Content</p>

  <ul>
    <li><a href="f.html">Hanzi table (front)</a></li>
    <li><a href="b.html">hanzi table (back)</a></li>
    <li><a href="h.html#æ®µ">info for example hanzi (æ®µ)</a></li>
    <li><a href="dict.html">word dictionary - list</a></li>
    <li><a href="dict-hsk.html">word dictionary - list (hsk)</a></li>
    <li><a href="dict-7000.html">word dictionary - list (7000 first hanzi)</a></li>
    <li><a href="dict-show-transl.html">word dictionary - table</a></li>
    <li><a href="dict-show-6000-transl.html">word dictionary - table (6000 first hanzi)</a></li>
  </ul>

  <p>Processed books</p>

  <ul>
    <li><a href="sherlock.html">sherlock</a></li>
    <li><a href="peppa/index.html">peppa</a></li>
    <li><a href="elon-musk/index.html">elon musk</a></li>
  </ul>

  <p>Make links and audio from your text ðŸ‘‡</p>

  <textarea style="width: 100%; min-height: 300px;"></textarea>

  <audio controls loop style="width: 100%;" id="baidu-tts-audio"></audio>
  <audio controls loop style="width: 100%;" id="google-tts-audio"></audio>

  <button id="audio-load">Audio load</button>
  <button id="baidu-tts-audio--open-new-tab">Baidu open new tab</button>
  <button id="google-tts-audio--open-new-tab">Google open new tab</button>
  <button id="bkrs--open-new-tab">Bkrs open new tab</button>

  <div id="textarea-output" class="strokeorderkanjiorhanzi verylarge" style="margin-top: 50px;"></div>

  <script>
const textarea_output = document.querySelector('#textarea-output')
const textarea = document.querySelector('textarea')

const googleAudioEl = document.getElementById('google-tts-audio')
const baiduAudioEl = document.getElementById('baidu-tts-audio')

const getAudioGoogleUrl = text => {
  return `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(text)}&tl=zh&total=1&idx=0&textlen=${text.length}&client=tw-ob&prev=input&ttsspeed=0.24`
};

const getAudioBaiduUrl = text => {
  // return `https://tts.baidu.com/text2audio?cuid=baike&lan=ZH&ctp=1&pdt=301&vol=9&rate=32&per=4&tex=${encodeURIComponent(text)}`
  return `https://fanyi.baidu.com/gettts?lan=zh&text=${encodeURIComponent(text)}&spd=2&source=web`
};

const getBkrsUrl = text => {
  return `https://bkrs.info/slovo.php?ch=${encodeURIComponent(text)}`
};

function update() {
  const text = textarea.value
  console.log(text)
  function addLinks(text) {
    const colorizer = ch => {
      return `<a target="_blank" href="h.html#${ch}">${ch}</a>`
    }
    return [...text].map(ch => isHanzi(ch) ? colorizer(ch) : ch).join('')
  }
  textarea_output.innerHTML = addLinks(text.replace(/\n/g, '<br>'))
}

update()
textarea.addEventListener('input', function (event) { update() });

document.getElementById('audio-load').addEventListener('click', function (event) {
  googleAudioEl.src = getAudioGoogleUrl(textarea.value)
  googleAudioEl.load()

  baiduAudioEl.src = getAudioBaiduUrl(textarea.value)
  baiduAudioEl.load()
});
document.getElementById('baidu-tts-audio--open-new-tab').addEventListener('click', function (event) { window.open(getAudioBaiduUrl(textarea.value), '_blank') });
document.getElementById('google-tts-audio--open-new-tab').addEventListener('click', function (event) { window.open(getAudioGoogleUrl(textarea.value), '_blank') });
document.getElementById('bkrs--open-new-tab').addEventListener('click', function (event) { window.open(getBkrsUrl(textarea.value), '_blank') });
  </script>
  </body>
</html>
